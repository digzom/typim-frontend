# ADR-009: Feature-Flagged Remediation Rollout and Rollback

## Status

Accepted

## Context

The remediation spans runtime behavior and CI policy. High-risk changes require controlled rollout and fast rollback that preserves regression detection.

## Decision

Keep feature flags as rollback control plane in `src/core/config.ts`, add CI jobs for targeted remediation checks plus full-suite validation, and document rollback procedure in `docs/qa/qa-runbook.md`.

## Consequences

### Positive

- Rollback remains explicit and low-risk through flag defaults and staged revert order.
- CI logs include feature-flag matrix evidence for cm6/livemd/scroll combinations.

### Negative

- CI duration increases due to targeted + full validation coverage.

### Neutral

- Default production-safe flag values remain unchanged.

## Related

- `.github/workflows/ci.yml`
- `src/core/config.ts`
- `docs/qa/qa-runbook.md`
- `tests/e2e/invariants.spec.ts`
